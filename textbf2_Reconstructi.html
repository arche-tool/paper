<h1 data-label="833026" class="ltx_title_section">Reconstruction algorithm</h1><div>The reconstruction algorithm consists of two major stages: 1)
calculation of observed orientation relationship and 2) clustering grain
by parental relationship. The first stage generates input information
for the second stage. The use of the first stage is optional, as one
could input a theoretical OR or OR measured/calculated from an external
source, but it’s highly recommended as the precise definition of the OR
has a direct impact on the final outcome of the reconstruction. The
proper value of OR highlights the gap between grain coming from distinct
parents and narrows the distance between related grains.</div><div>Both stages have a pre-processing step to identify some microstructure
features. The two main features that are relevant for the reconstruction
algorithm are: grain boundary surfaces and grain volumes. Those features
are identified, respectively, as a set of discrete voxel faces and
discrete voxel volumes derived from the orientation grid provided by the
input ANG file.</div><h2 data-label="707851" class="ltx_title_subsection">Pre-processing</h2><div>Both OR calculation and phase reconstruction are based on the abstract
concept of grains and its grain boundaries, as well as the
crystallographic orientation associated to each entity. The trivial
method to obtain such kind of information is through EBSD scan maps. But
those are, regardless of the format ANG or CTF, a simple grid of
discrete orientation points and a pre-processing step to identify the
microstructure features is necessary.</div><div>The algorithm starts by parsing the ANG file and converting it to a
rectangular grid (if the input file is using the hexagonal grid), then
each measured point is converted into a voxel representation. A <span class="au-background-yellow" data-background="true" data-comment-id="179660">voxel</span> is
a volume atomic unit in a three-dimensional regular grid, therefore it
has a regular position that can be indexed and well defined surface
boundaries.</div><div>For every voxel, the misorientation between itself and its neighbors are
calculated at the voxel faces: . This can be
modeled as a graph where voxels are nodes and voxel face form edges
between nodes. The edge weight is given by misorientation angle.</div><div>By pruning edges with higher values of misorientation values (by default this value is set to 5°), the grains are simply defined as the set of voxels forming each connected graph network. Each grain can now receive a unique ID number (<span class="math ltx_Math v1">\(G_{id}\)</span>).</div><div>Grain boundaries are defined as the set voxel faces where&nbsp;<span class="math ltx_Math v1">\(G_{id}^A\ne G_{id}^B\)</span> for the any neighbouring voxel <span class="math ltx_Math v1">\(A\)</span>&nbsp; and <span class="math ltx_Math v1">\(B\)</span>. The can be easily find by filtering the pruned edges from the previous step.</div>
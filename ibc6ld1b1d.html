<div>Once the graph is constructed, the algorithm works by refining the clusters iteratively on a sequence of steps. At the first step, the clusters are determined&nbsp;<span class="au-background-yellow" data-background="true" data-comment-id="181268" data-is-resolved="true"> by setting&nbsp;<span class="math ltx_Math v1">\(\Gamma\)</span></span> to&nbsp;the lowest value (i.e.&nbsp;<span class="math ltx_Math v1">\(1.2
\)</span>), resulting in the&nbsp;highest level of&nbsp;<span class="au-background-yellow" data-background="true" data-comment-id="182333">coarsening</span> (cf. Figure&nbsp;<span class="au-ref raw v1">\ref{394885}</span>b). Then each of the formed clusters becomes a candidate<span class="au-background-yellow" data-background="true"> for a</span> parent grain and a special procedure is applied to determine the mostly likely parent orientation and if the parent candidate is a good fit.</div><div> The process to determine the most likely parent orientation starts  by placing the all possible parent orientation of a product grain in the cluster into a ODF(Orientation Distribution Function) space. They are calculated using all variants of the OR applied to Equation&nbsp;<span class="au-ref raw v1">\ref{eq:1}</span> with&nbsp;<span class="math ltx_Math v1">\(\Delta g = 0\)</span> and placed into the ODF with a Gaussian spread of&nbsp;<span class="math ltx_Math v1">\(5^{\circ}\)</span>, as shown the the simplified&nbsp;schematic with one dimensional ODF  on Figure&nbsp;<span class="au-ref raw v1">\ref{747389}</span>a.&nbsp; The previous calculation happens to all product grains member of a cluster on the same ODF space (cf. Figure&nbsp;<span class="au-ref raw v1">\ref{747389}</span>b). Then the KDE (Kernel Density Estimation)&nbsp; is calculated over all the Gaussians to determine the final ODF of all possible parent orientations (cf. Figure&nbsp;<span class="au-ref raw v1">\ref{747389}</span>c).&nbsp; Finally, the mostly likely parent orientation is  obtained by finding the&nbsp;<span class="au-background-yellow" data-background="true" data-comment-id="182334">mode&nbsp;of the final ODF (i.e. the orientation that produces maximum value on the probability function)</span>.</div><div>Once a parent grain candidate has its orientation calculated, a fitness score can also be dertemined. The fitness score is a simple binary value defined by the following rule: if for every product grain the misfit error is less or equal than a threshold value (default value is&nbsp;<span class="math ltx_Math v1">\(5^{\circ}\)</span>) then the fitness score is&nbsp;<span class="math ltx_Math v1">\(1\)</span> otherwise it is&nbsp;<span class="math ltx_Math v1">\(0\)</span>. Where the misfit error is the&nbsp;<span class="math ltx_Math v1">\(\Delta g\)</span> on Equation&nbsp;<span class="au-ref raw v1">\ref{eq:1}</span> given the OR, product and parent orientations. The goal of the fitness score is identify parent grain candidates that are to gross and actually constains product grains from more the one parent. Moreover, the fitness calculation not only identifies bad parent grains but also which product members are likely coming from a different parent. Here the usage of the ODF mode instead of orientation average helps to highlight the differences between grains coming from different parents by improving the signal/noise ratio. The calculation of an average value  is disturbed by the presence of outliers (noise) wheter where the mode value reamains stable.&nbsp;&nbsp;</div>
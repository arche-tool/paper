<div>In order to use the clustering algorithm, a graph has to be derived from the OIM in the following way: (a) each grain, product or parent, becomes a node in the graph, (b) each grain boundary becomes an edge connecting two neighboring nodes (grains) and (c) each edge receives a value based on the equation (1) or (2), which determines the probability of the two neighboring grains being products of the same parent. Once the graph is constructed, the clusters are determined using the highest level of coarsening. Then each cluster forms a parent grain and its orientation is calculated by an optimization algorithm that minimizes the average angular deviation using the equation (1).</div>